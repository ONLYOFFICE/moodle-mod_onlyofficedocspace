/**
 * @module mod_onlyofficedocspace/docspace_integration_sdk
 * @copyright  2025 Ascensio System SIA <integration@onlyoffice.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 **/
define("mod_onlyofficedocspace/docspace_integration_sdk",[],(function(){const _createScriptTag=(id,url,resolve,reject)=>{const script=document.createElement("script");return script.id=id,script.type="text/javascript",script.src=url.endsWith("/")?url+"static/scripts/sdk/1.0.1/api.js":url+"/static/scripts/sdk/1.0.1/api.js",script.async=!0,script.onload=()=>{script.removeAttribute("loading"),resolve(null)},script.onerror=error=>{script.removeAttribute("loading"),reject(error)},script.setAttribute("loading",""),script},loginByPasswordHash=function(frameId,email,onRequestPasswordHash,onSuccessLogin,onUnSuccessLogin,onAppError){DocSpace.SDK.initSystem({frameId:frameId,width:"100%",height:"100%",events:{onAppReady:async function(){const userInfo=await DocSpace.SDK.frames[frameId].getUserInfo();if(userInfo&&userInfo.email===email)onSuccessLogin();else{const passwordHash=await onRequestPasswordHash(email);if(null===passwordHash||passwordHash.length<=0)return DocSpace.SDK.frames[frameId].destroyFrame(),void onUnSuccessLogin();DocSpace.SDK.frames[frameId].login(email,passwordHash).then((function(response){if(response.status&&200!==response.status)return DocSpace.SDK.frames[frameId].destroyFrame(),void onUnSuccessLogin();onSuccessLogin(passwordHash)}))}},onAppError:async function(){onAppError&&onAppError()}}})};return{initScript:async(id,url)=>new Promise(((resolve,reject)=>{try{if("undefined"!=typeof DocSpace&&null!==DocSpace)return resolve(null);if(null===url)return reject("DocSpace Url is not defined!");const existedScript=document.getElementById(id);if(existedScript){let intervalHandler=setInterval((()=>{if(!existedScript.getAttribute("loading")){if(clearInterval(intervalHandler),"undefined"!=typeof DocSpace)return resolve(null);const script=_createScriptTag(id,url,resolve,reject);existedScript.remove(),document.body.appendChild(script)}}),500)}else{const script=_createScriptTag(id,url,resolve,reject);document.body.appendChild(script)}}catch(e){console.error(e)}})),initialized:function(){return"undefined"!=typeof DocSpace&&null!==DocSpace},loginByPassword:function(frameId,email,password,onSuccessLogin,onUnSuccessLogin,onAppError){loginByPasswordHash(frameId,email,(async function(email){const hashSettings=await DocSpace.SDK.frames[frameId].getHashSettings();return await DocSpace.SDK.frames[frameId].createHash(password.trim(),hashSettings)}),onSuccessLogin,onUnSuccessLogin,onAppError)},loginByPasswordHash:loginByPasswordHash,logout:function(frameId,onLogout,onAppError){DocSpace.SDK.initSystem({frameId:frameId,width:"100%",height:"100%",events:{onAppReady:async function(){await DocSpace.SDK.frames[frameId].getUserInfo()?DocSpace.SDK.frames[frameId].logout().then((function(){onLogout()})):onLogout()},onAppError:async function(){onAppError&&onAppError()}}})},apiUrl:"static/scripts/sdk/1.0.1/api.js"}}));

//# sourceMappingURL=docspace_integration_sdk.min.js.map